"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[9091],{28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>l});var t=s(96540);const r={},i=t.createContext(r);function d(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(i.Provider,{value:n},e.children)}},71006:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"api/ip-allowlist","title":"IP Allowlist","description":"Restrict API and dashboard access to specific IP addresses.","source":"@site/docs/api/ip-allowlist.mdx","sourceDirName":"api","slug":"/api/ip-allowlist","permalink":"/api/ip-allowlist","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"sidebar_position":16,"title":"IP Allowlist","description":"Restrict API and dashboard access to specific IP addresses."},"sidebar":"tutorialSidebar","previous":{"title":"BigQuery Integration","permalink":"/api/bigquery"},"next":{"title":"Auth Advanced","permalink":"/api/auth-advanced"}}');var r=s(74848),i=s(28453);const d={sidebar_position:16,title:"IP Allowlist",description:"Restrict API and dashboard access to specific IP addresses."},l="IP Allowlist",c={},a=[{value:"Overview",id:"overview",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"Settings",id:"settings",level:2},{value:"Get Settings",id:"get-settings",level:3},{value:"Update Settings",id:"update-settings",level:3},{value:"IP Patterns",id:"ip-patterns",level:2},{value:"List Patterns",id:"list-patterns",level:3},{value:"Add Pattern",id:"add-pattern",level:3},{value:"Update Pattern",id:"update-pattern",level:3},{value:"Delete Pattern",id:"delete-pattern",level:3},{value:"Bulk Operations",id:"bulk-operations",level:2},{value:"Add Multiple Patterns",id:"add-multiple-patterns",level:3},{value:"Delete Multiple Patterns",id:"delete-multiple-patterns",level:3},{value:"Import/Export",id:"importexport",level:2},{value:"Export Patterns",id:"export-patterns",level:3},{value:"Import Patterns",id:"import-patterns",level:3},{value:"Validation",id:"validation",level:2},{value:"Check IP Address",id:"check-ip-address",level:3},{value:"Check Current IP",id:"check-current-ip",level:3},{value:"Audit Log",id:"audit-log",level:2},{value:"Get Audit Log",id:"get-audit-log",level:3},{value:"Event Types",id:"event-types",level:3},{value:"Code Examples",id:"code-examples",level:2},{value:"Python - Setup Allowlist",id:"python---setup-allowlist",level:3},{value:"JavaScript - Monitor Denied Access",id:"javascript---monitor-denied-access",level:3},{value:"Backup and Restore",id:"backup-and-restore",level:3},{value:"Error Codes",id:"error-codes",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Start with API Only",id:"1-start-with-api-only",level:3},{value:"2. Always Include Your IP",id:"2-always-include-your-ip",level:3},{value:"3. Use CIDR for Office Networks",id:"3-use-cidr-for-office-networks",level:3},{value:"4. Keep Owner Bypass Enabled",id:"4-keep-owner-bypass-enabled",level:3},{value:"5. Monitor the Audit Log",id:"5-monitor-the-audit-log",level:3},{value:"6. Document Your Patterns",id:"6-document-your-patterns",level:3}];function o(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"ip-allowlist",children:"IP Allowlist"})}),"\n",(0,r.jsx)(n.p,{children:"Restrict access to your Sealmetrics account by whitelisting specific IP addresses or CIDR ranges."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"IP Allowlist provides:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Access control for API requests"}),"\n",(0,r.jsx)(n.li,{children:"Optional dashboard login restrictions"}),"\n",(0,r.jsx)(n.li,{children:"Support for individual IPs and CIDR ranges"}),"\n",(0,r.jsx)(n.li,{children:"Bulk import/export of patterns"}),"\n",(0,r.jsx)(n.li,{children:"Audit logging of access attempts"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Base path:"})," ",(0,r.jsx)(n.code,{children:"/ip-allowlist"})]}),"\n",(0,r.jsx)(n.admonition,{title:"Enterprise Feature",type:"note",children:(0,r.jsx)(n.p,{children:"IP Allowlist is available on Enterprise plans only."})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,r.jsx)(n.p,{children:"When enabled:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Every API request is checked against the allowlist"}),"\n",(0,r.jsxs)(n.li,{children:["Requests from non-allowed IPs receive ",(0,r.jsx)(n.code,{children:"403 Forbidden"})]}),"\n",(0,r.jsx)(n.li,{children:"Dashboard logins can optionally be restricted"}),"\n",(0,r.jsx)(n.li,{children:"All access attempts are logged for audit"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"settings",children:"Settings"}),"\n",(0,r.jsx)(n.h3,{id:"get-settings",children:"Get Settings"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /ip-allowlist/settings?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "enabled": true,\n    "enforce_on_api": true,\n    "enforce_on_dashboard": false,\n    "allow_owner_bypass": true,\n    "patterns_count": 5,\n    "last_updated_at": "2025-01-10T14:30:00Z"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"enabled"})}),(0,r.jsx)(n.td,{children:"Allowlist is active"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"enforce_on_api"})}),(0,r.jsx)(n.td,{children:"Check IPs for API requests"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"enforce_on_dashboard"})}),(0,r.jsx)(n.td,{children:"Check IPs for dashboard login"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"allow_owner_bypass"})}),(0,r.jsx)(n.td,{children:"Organization owners bypass restrictions"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"patterns_count"})}),(0,r.jsx)(n.td,{children:"Number of configured patterns"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"update-settings",children:"Update Settings"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"PUT /ip-allowlist/settings?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "enabled": true,\n  "enforce_on_api": true,\n  "enforce_on_dashboard": true,\n  "allow_owner_bypass": true\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "enabled": true,\n    "enforce_on_api": true,\n    "enforce_on_dashboard": true,\n    "allow_owner_bypass": true,\n    "message": "Settings updated successfully"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["Enabling ",(0,r.jsx)(n.code,{children:"enforce_on_dashboard"})," without adding your current IP will lock you out. Always test with ",(0,r.jsx)(n.code,{children:"enforce_on_api"})," first."]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"ip-patterns",children:"IP Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"list-patterns",children:"List Patterns"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /ip-allowlist/patterns?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Query Parameters:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"page"})}),(0,r.jsx)(n.td,{children:"integer"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"1"})}),(0,r.jsx)(n.td,{children:"Page number"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"page_size"})}),(0,r.jsx)(n.td,{children:"integer"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"50"})}),(0,r.jsx)(n.td,{children:"Items per page (1-100)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"search"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Search in pattern or description"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "patterns": [\n      {\n        "id": 1,\n        "pattern": "203.0.113.0/24",\n        "type": "cidr",\n        "description": "Office network",\n        "is_active": true,\n        "created_by": "admin@company.com",\n        "created_at": "2025-01-01T10:00:00Z",\n        "last_matched_at": "2025-01-10T14:30:00Z",\n        "match_count": 1542\n      },\n      {\n        "id": 2,\n        "pattern": "198.51.100.50",\n        "type": "ip",\n        "description": "CI/CD server",\n        "is_active": true,\n        "created_by": "admin@company.com",\n        "created_at": "2025-01-05T09:00:00Z",\n        "last_matched_at": "2025-01-10T12:00:00Z",\n        "match_count": 890\n      }\n    ],\n    "total": 5,\n    "page": 1,\n    "page_size": 50\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"add-pattern",children:"Add Pattern"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"POST /ip-allowlist/patterns?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "pattern": "203.0.113.0/24",\n  "description": "Office network",\n  "is_active": true\n}\n'})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"pattern"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"IP address or CIDR range"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"description"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Human-readable description"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"is_active"})}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Enable pattern (default: true)"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Supported Formats:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Format"}),(0,r.jsx)(n.th,{children:"Example"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IPv4"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"192.168.1.1"})}),(0,r.jsx)(n.td,{children:"Single IP address"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IPv4 CIDR"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"192.168.1.0/24"})}),(0,r.jsx)(n.td,{children:"IP range (256 addresses)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IPv6"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2001:db8::1"})}),(0,r.jsx)(n.td,{children:"Single IPv6 address"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IPv6 CIDR"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2001:db8::/32"})}),(0,r.jsx)(n.td,{children:"IPv6 range"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response (201 Created):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "id": 3,\n    "pattern": "203.0.113.0/24",\n    "type": "cidr",\n    "description": "Office network",\n    "is_active": true,\n    "created_by": "admin@company.com",\n    "created_at": "2025-01-10T15:00:00Z"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"update-pattern",children:"Update Pattern"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"PATCH /ip-allowlist/patterns/{pattern_id}?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "description": "Main office network",\n  "is_active": true\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"delete-pattern",children:"Delete Pattern"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"DELETE /ip-allowlist/patterns/{pattern_id}?site_id={site_id}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Response:"})," 204 No Content"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"bulk-operations",children:"Bulk Operations"}),"\n",(0,r.jsx)(n.h3,{id:"add-multiple-patterns",children:"Add Multiple Patterns"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"POST /ip-allowlist/patterns/bulk?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "patterns": [\n    {"pattern": "203.0.113.0/24", "description": "Office A"},\n    {"pattern": "198.51.100.0/24", "description": "Office B"},\n    {"pattern": "192.0.2.50", "description": "VPN endpoint"}\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "created": 3,\n    "skipped": 0,\n    "errors": [],\n    "patterns": [\n      {"id": 4, "pattern": "203.0.113.0/24"},\n      {"id": 5, "pattern": "198.51.100.0/24"},\n      {"id": 6, "pattern": "192.0.2.50"}\n    ]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"delete-multiple-patterns",children:"Delete Multiple Patterns"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"POST /ip-allowlist/patterns/bulk-delete?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "pattern_ids": [4, 5, 6]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "deleted": 3,\n    "message": "Patterns deleted successfully"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"importexport",children:"Import/Export"}),"\n",(0,r.jsx)(n.h3,{id:"export-patterns",children:"Export Patterns"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /ip-allowlist/export?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Export all patterns as JSON for backup or transfer."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "exported_at": "2025-01-10T15:00:00Z",\n    "site_id": "my-site",\n    "patterns_count": 5,\n    "patterns": [\n      {"pattern": "203.0.113.0/24", "description": "Office A", "is_active": true},\n      {"pattern": "198.51.100.0/24", "description": "Office B", "is_active": true},\n      {"pattern": "192.0.2.50", "description": "VPN", "is_active": true}\n    ]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"import-patterns",children:"Import Patterns"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"POST /ip-allowlist/import?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Import patterns from a previous export."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "patterns": [\n    {"pattern": "203.0.113.0/24", "description": "Office A", "is_active": true},\n    {"pattern": "198.51.100.0/24", "description": "Office B", "is_active": true}\n  ],\n  "mode": "merge"\n}\n'})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"patterns"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"Patterns to import"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mode"})}),(0,r.jsx)(n.td,{children:"enum"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"merge"})," (add new) or ",(0,r.jsx)(n.code,{children:"replace"})," (delete existing first)"]})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "imported": 2,\n    "skipped": 0,\n    "errors": [],\n    "mode": "merge"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"validation",children:"Validation"}),"\n",(0,r.jsx)(n.h3,{id:"check-ip-address",children:"Check IP Address"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"POST /ip-allowlist/check?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Test if an IP would be allowed."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "ip_address": "203.0.113.50"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "ip_address": "203.0.113.50",\n    "allowed": true,\n    "matched_pattern": {\n      "id": 1,\n      "pattern": "203.0.113.0/24",\n      "description": "Office network"\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response (not allowed):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "ip_address": "198.51.100.99",\n    "allowed": false,\n    "matched_pattern": null\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"check-current-ip",children:"Check Current IP"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /ip-allowlist/check-current?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Check if your current IP is allowed."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "your_ip": "203.0.113.50",\n    "allowed": true,\n    "matched_pattern": {\n      "id": 1,\n      "pattern": "203.0.113.0/24",\n      "description": "Office network"\n    },\n    "warning": null\n  }\n}\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["Always use ",(0,r.jsx)(n.code,{children:"/check-current"})," before enabling ",(0,r.jsx)(n.code,{children:"enforce_on_dashboard"})," to ensure you won't be locked out."]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"audit-log",children:"Audit Log"}),"\n",(0,r.jsx)(n.h3,{id:"get-audit-log",children:"Get Audit Log"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"GET /ip-allowlist/audit?site_id={site_id}\n"})}),"\n",(0,r.jsx)(n.p,{children:"View access attempts and configuration changes."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Query Parameters:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"page"})}),(0,r.jsx)(n.td,{children:"integer"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"1"})}),(0,r.jsx)(n.td,{children:"Page number"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"page_size"})}),(0,r.jsx)(n.td,{children:"integer"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"50"})}),(0,r.jsx)(n.td,{children:"Items per page"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"event_type"})}),(0,r.jsx)(n.td,{children:"enum"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Filter: ",(0,r.jsx)(n.code,{children:"access_denied"}),", ",(0,r.jsx)(n.code,{children:"access_granted"}),", ",(0,r.jsx)(n.code,{children:"config_changed"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"date_from"})}),(0,r.jsx)(n.td,{children:"date"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Start date (YYYY-MM-DD)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"date_to"})}),(0,r.jsx)(n.td,{children:"date"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"End date (YYYY-MM-DD)"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "events": [\n      {\n        "id": 1234,\n        "event_type": "access_denied",\n        "ip_address": "198.51.100.99",\n        "user_agent": "Python/3.9 requests/2.28.0",\n        "endpoint": "/api/v1/stats/overview",\n        "timestamp": "2025-01-10T14:35:00Z"\n      },\n      {\n        "id": 1233,\n        "event_type": "config_changed",\n        "action": "pattern_added",\n        "details": {"pattern": "203.0.113.0/24"},\n        "user_email": "admin@company.com",\n        "ip_address": "203.0.113.50",\n        "timestamp": "2025-01-10T14:30:00Z"\n      }\n    ],\n    "total": 156,\n    "page": 1,\n    "page_size": 50\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"event-types",children:"Event Types"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"access_granted"})}),(0,r.jsx)(n.td,{children:"Request from allowed IP"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"access_denied"})}),(0,r.jsx)(n.td,{children:"Request from non-allowed IP"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"config_changed"})}),(0,r.jsx)(n.td,{children:"Settings or patterns modified"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bypass_used"})}),(0,r.jsx)(n.td,{children:"Owner used bypass privilege"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"code-examples",children:"Code Examples"}),"\n",(0,r.jsx)(n.h3,{id:"python---setup-allowlist",children:"Python - Setup Allowlist"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import requests\n\nAPI_KEY = "sm_your_api_key"\nBASE_URL = "https://api.sealmetrics.com/api/v1"\nSITE_ID = "my-site"\n\ndef setup_ip_allowlist(office_ips, vpn_ips):\n    """Configure IP allowlist with office and VPN IPs."""\n\n    # First, check current IP is in the list\n    current_response = requests.get(\n        f"{BASE_URL}/ip-allowlist/check-current",\n        headers={"X-API-Key": API_KEY},\n        params={"site_id": SITE_ID}\n    )\n    current_ip = current_response.json()["data"]["your_ip"]\n\n    # Build patterns list\n    patterns = []\n\n    for ip in office_ips:\n        patterns.append({"pattern": ip, "description": "Office"})\n\n    for ip in vpn_ips:\n        patterns.append({"pattern": ip, "description": "VPN"})\n\n    # Add current IP if not covered\n    if not current_response.json()["data"]["allowed"]:\n        patterns.append({"pattern": current_ip, "description": "Admin IP"})\n\n    # Bulk add patterns\n    requests.post(\n        f"{BASE_URL}/ip-allowlist/patterns/bulk",\n        headers={"X-API-Key": API_KEY},\n        params={"site_id": SITE_ID},\n        json={"patterns": patterns}\n    )\n\n    # Enable for API only (safer)\n    requests.put(\n        f"{BASE_URL}/ip-allowlist/settings",\n        headers={"X-API-Key": API_KEY},\n        params={"site_id": SITE_ID},\n        json={\n            "enabled": True,\n            "enforce_on_api": True,\n            "enforce_on_dashboard": False,\n            "allow_owner_bypass": True\n        }\n    )\n\n    print(f"IP allowlist configured with {len(patterns)} patterns")\n\n\n# Usage\nsetup_ip_allowlist(\n    office_ips=["203.0.113.0/24", "198.51.100.0/24"],\n    vpn_ips=["192.0.2.10", "192.0.2.11"]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"javascript---monitor-denied-access",children:"JavaScript - Monitor Denied Access"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"async function getRecentDeniedAccess(hours = 24) {\n  const dateFrom = new Date(Date.now() - hours * 60 * 60 * 1000)\n    .toISOString()\n    .split('T')[0];\n\n  const response = await fetch(\n    `${BASE_URL}/ip-allowlist/audit?site_id=${SITE_ID}&event_type=access_denied&date_from=${dateFrom}`,\n    {\n      headers: { 'X-API-Key': API_KEY }\n    }\n  );\n\n  const { data } = await response.json();\n\n  // Group by IP\n  const byIp = {};\n  for (const event of data.events) {\n    byIp[event.ip_address] = (byIp[event.ip_address] || 0) + 1;\n  }\n\n  console.log('Denied access attempts by IP:');\n  for (const [ip, count] of Object.entries(byIp)) {\n    console.log(`  ${ip}: ${count} attempts`);\n  }\n\n  return byIp;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"backup-and-restore",children:"Backup and Restore"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import json\n\ndef backup_allowlist(output_file):\n    """Export allowlist to file."""\n    response = requests.get(\n        f"{BASE_URL}/ip-allowlist/export",\n        headers={"X-API-Key": API_KEY},\n        params={"site_id": SITE_ID}\n    )\n\n    with open(output_file, "w") as f:\n        json.dump(response.json()["data"], f, indent=2)\n\n    print(f"Exported {response.json()[\'data\'][\'patterns_count\']} patterns")\n\n\ndef restore_allowlist(input_file, mode="merge"):\n    """Import allowlist from file."""\n    with open(input_file) as f:\n        data = json.load(f)\n\n    response = requests.post(\n        f"{BASE_URL}/ip-allowlist/import",\n        headers={"X-API-Key": API_KEY},\n        params={"site_id": SITE_ID},\n        json={\n            "patterns": data["patterns"],\n            "mode": mode\n        }\n    )\n\n    result = response.json()["data"]\n    print(f"Imported: {result[\'imported\']}, Skipped: {result[\'skipped\']}")\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"error-codes",children:"Error Codes"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"HTTP Code"}),(0,r.jsx)(n.th,{children:"Error"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"400"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"invalid_pattern"})}),(0,r.jsx)(n.td,{children:"IP or CIDR format is invalid"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"400"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"duplicate_pattern"})}),(0,r.jsx)(n.td,{children:"Pattern already exists"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"403"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ip_not_allowed"})}),(0,r.jsx)(n.td,{children:"Your IP is not in the allowlist"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"404"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"pattern_not_found"})}),(0,r.jsx)(n.td,{children:"Pattern ID not found"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"409"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"would_lock_out"})}),(0,r.jsx)(n.td,{children:"Operation would lock out all users"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-start-with-api-only",children:"1. Start with API Only"}),"\n",(0,r.jsxs)(n.p,{children:["Enable ",(0,r.jsx)(n.code,{children:"enforce_on_api"})," first, test thoroughly, then enable ",(0,r.jsx)(n.code,{children:"enforce_on_dashboard"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"2-always-include-your-ip",children:"2. Always Include Your IP"}),"\n",(0,r.jsx)(n.p,{children:"Before enabling, verify your current IP is covered:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl "https://api.sealmetrics.com/api/v1/ip-allowlist/check-current?site_id=my-site" \\\n  -H "X-API-Key: sm_your_api_key"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-use-cidr-for-office-networks",children:"3. Use CIDR for Office Networks"}),"\n",(0,r.jsx)(n.p,{children:"Instead of individual IPs, use CIDR ranges for office networks:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Bad: Individual IPs\n192.168.1.1\n192.168.1.2\n192.168.1.3\n\n# Good: CIDR range\n192.168.1.0/24\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-keep-owner-bypass-enabled",children:"4. Keep Owner Bypass Enabled"}),"\n",(0,r.jsxs)(n.p,{children:["Leave ",(0,r.jsx)(n.code,{children:"allow_owner_bypass: true"})," as a safety net to recover from misconfigurations."]}),"\n",(0,r.jsx)(n.h3,{id:"5-monitor-the-audit-log",children:"5. Monitor the Audit Log"}),"\n",(0,r.jsxs)(n.p,{children:["Regularly review ",(0,r.jsx)(n.code,{children:"access_denied"})," events to detect unauthorized access attempts or legitimate users being blocked."]}),"\n",(0,r.jsx)(n.h3,{id:"6-document-your-patterns",children:"6. Document Your Patterns"}),"\n",(0,r.jsxs)(n.p,{children:["Use the ",(0,r.jsx)(n.code,{children:"description"})," field to document what each pattern is for:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "pattern": "203.0.113.0/24",\n  "description": "NYC Office - Floor 3-5 - Added Jan 2025"\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);