"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[5429],{28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>l});var i=s(96540);const t={},r=i.createContext(t);function d(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(r.Provider,{value:n},e.children)}},82020:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"api/webhooks","title":"Webhooks","description":"Real-time event notifications via HTTP callbacks.","source":"@site/docs/api/webhooks.mdx","sourceDirName":"api","slug":"/api/webhooks","permalink":"/api/webhooks","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12,"title":"Webhooks","description":"Real-time event notifications via HTTP callbacks."},"sidebar":"tutorialSidebar","previous":{"title":"Segments","permalink":"/api/segments"},"next":{"title":"Alerts","permalink":"/api/alerts"}}');var t=s(74848),r=s(28453);const d={sidebar_position:12,title:"Webhooks",description:"Real-time event notifications via HTTP callbacks."},l="Webhooks API",a={},o=[{value:"Overview",id:"overview",level:2},{value:"Endpoints",id:"endpoints",level:2},{value:"List Webhook Endpoints",id:"list-webhook-endpoints",level:3},{value:"Create Webhook Endpoint",id:"create-webhook-endpoint",level:3},{value:"Get Webhook Endpoint",id:"get-webhook-endpoint",level:3},{value:"Update Webhook Endpoint",id:"update-webhook-endpoint",level:3},{value:"Delete Webhook Endpoint",id:"delete-webhook-endpoint",level:3},{value:"Event Types",id:"event-types",level:2},{value:"List Available Event Types",id:"list-available-event-types",level:3},{value:"Testing",id:"testing",level:2},{value:"Send Test Webhook",id:"send-test-webhook",level:3},{value:"Secret Rotation",id:"secret-rotation",level:2},{value:"Rotate Webhook Secret",id:"rotate-webhook-secret",level:3},{value:"Deliveries",id:"deliveries",level:2},{value:"List Deliveries",id:"list-deliveries",level:3},{value:"Get Delivery Details",id:"get-delivery-details",level:3},{value:"Replay Delivery",id:"replay-delivery",level:3},{value:"Bulk Replay",id:"bulk-replay",level:3},{value:"Statistics",id:"statistics",level:2},{value:"Get Endpoint Statistics",id:"get-endpoint-statistics",level:3},{value:"Webhook Payload",id:"webhook-payload",level:2},{value:"Alert Triggered",id:"alert-triggered",level:3},{value:"Export Completed",id:"export-completed",level:3},{value:"Signature Verification",id:"signature-verification",level:2},{value:"Verification Steps",id:"verification-steps",level:3},{value:"Python Example",id:"python-example",level:3},{value:"Node.js Example",id:"nodejs-example",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Verify Signatures",id:"1-verify-signatures",level:3},{value:"2. Respond Quickly",id:"2-respond-quickly",level:3},{value:"3. Handle Duplicates",id:"3-handle-duplicates",level:3},{value:"4. Use HTTPS",id:"4-use-https",level:3},{value:"5. Rotate Secrets Periodically",id:"5-rotate-secrets-periodically",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"webhooks-api",children:"Webhooks API"})}),"\n",(0,t.jsx)(n.p,{children:"Receive real-time notifications when events occur in your Sealmetrics account."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"Webhooks allow you to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Receive instant notifications when alerts trigger"}),"\n",(0,t.jsx)(n.li,{children:"Get notified when exports complete"}),"\n",(0,t.jsx)(n.li,{children:"Integrate with external systems (Slack, Zapier, custom apps)"}),"\n",(0,t.jsx)(n.li,{children:"Build real-time dashboards and alerting systems"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"All webhooks are:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Signed with HMAC-SHA256 for security"}),"\n",(0,t.jsx)(n.li,{children:"Retried automatically on failure (up to 5 attempts)"}),"\n",(0,t.jsx)(n.li,{children:"Logged for debugging and replay"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,t.jsx)(n.h3,{id:"list-webhook-endpoints",children:"List Webhook Endpoints"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"GET /webhooks?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Query Parameters:"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"site_id"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Required. Site ID"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"include_inactive"})}),(0,t.jsx)(n.td,{children:"boolean"}),(0,t.jsx)(n.td,{children:"Include disabled endpoints"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"limit"})}),(0,t.jsx)(n.td,{children:"int"}),(0,t.jsx)(n.td,{children:"Max results (default: 50)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"offset"})}),(0,t.jsx)(n.td,{children:"int"}),(0,t.jsx)(n.td,{children:"Pagination offset"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "endpoints": [\n    {\n      "id": "550e8400-e29b-41d4-a716-446655440000",\n      "site_id": "acme",\n      "name": "Slack Alerts",\n      "url": "https://hooks.slack.com/services/xxx",\n      "event_types": ["alert.triggered"],\n      "is_active": true,\n      "is_verified": true,\n      "secret_last_4": "a1b2",\n      "created_at": "2025-01-01T10:00:00Z",\n      "last_delivery_at": "2025-01-10T14:30:00Z"\n    }\n  ],\n  "total": 1\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"create-webhook-endpoint",children:"Create Webhook Endpoint"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"POST /webhooks?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "My Webhook",\n  "url": "https://my-app.com/webhooks/sealmetrics",\n  "event_types": ["alert.triggered", "export.completed"],\n  "headers": {\n    "X-Custom-Header": "value"\n  },\n  "description": "Notifications for my dashboard"\n}\n'})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Required"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"name"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"Display name (max 255 chars)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"url"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"HTTPS endpoint URL"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"event_types"})}),(0,t.jsx)(n.td,{children:"string[]"}),(0,t.jsx)(n.td,{children:"Yes"}),(0,t.jsx)(n.td,{children:"Events to subscribe to"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"headers"})}),(0,t.jsx)(n.td,{children:"object"}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:"Custom headers to include"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"description"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:"Description for reference"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response (201 Created):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "550e8400-e29b-41d4-a716-446655440000",\n  "site_id": "acme",\n  "name": "My Webhook",\n  "url": "https://my-app.com/webhooks/sealmetrics",\n  "event_types": ["alert.triggered", "export.completed"],\n  "secret": "whsec_abc123def456...",\n  "is_active": true,\n  "is_verified": false,\n  "created_at": "2025-01-10T14:30:00Z"\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Important:"})," The ",(0,t.jsx)(n.code,{children:"secret"})," is only returned once. Store it securely for signature verification."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"get-webhook-endpoint",children:"Get Webhook Endpoint"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"GET /webhooks/{endpoint_id}?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"update-webhook-endpoint",children:"Update Webhook Endpoint"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"PATCH /webhooks/{endpoint_id}?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "name": "Updated Name",\n  "url": "https://new-url.com/webhook",\n  "event_types": ["alert.triggered"],\n  "is_active": false\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"All fields are optional. Only provided fields are updated."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"delete-webhook-endpoint",children:"Delete Webhook Endpoint"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"DELETE /webhooks/{endpoint_id}?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Deletes the endpoint and all delivery history."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"event-types",children:"Event Types"}),"\n",(0,t.jsx)(n.h3,{id:"list-available-event-types",children:"List Available Event Types"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"GET /webhooks/event-types\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "event_types": [\n    {\n      "type": "alert.triggered",\n      "name": "Alert Triggered",\n      "description": "Fired when an anomaly alert triggers"\n    },\n    {\n      "type": "alert.resolved",\n      "name": "Alert Resolved",\n      "description": "Fired when an alert condition resolves"\n    },\n    {\n      "type": "export.completed",\n      "name": "Export Completed",\n      "description": "Fired when a bulk export finishes"\n    },\n    {\n      "type": "export.failed",\n      "name": "Export Failed",\n      "description": "Fired when a bulk export fails"\n    },\n    {\n      "type": "insight.created",\n      "name": "Insight Created",\n      "description": "Fired when LENS generates a new insight"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,t.jsx)(n.h3,{id:"send-test-webhook",children:"Send Test Webhook"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"POST /webhooks/{endpoint_id}/test?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Sends a test event to verify your endpoint is correctly configured."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Request Body (optional):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "event_type": "alert.triggered",\n  "include_sample_context": true\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "delivery_id": "d-12345",\n  "response_status": 200,\n  "response_time_ms": 145,\n  "verified": true\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["On first successful test, the endpoint is marked as ",(0,t.jsx)(n.code,{children:"verified"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"secret-rotation",children:"Secret Rotation"}),"\n",(0,t.jsx)(n.h3,{id:"rotate-webhook-secret",children:"Rotate Webhook Secret"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"POST /webhooks/{endpoint_id}/rotate-secret?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Generates a new secret key. The previous secret remains valid for 24 hours to allow graceful migration."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "new_secret": "whsec_new123...",\n  "previous_secret_expires_at": "2025-01-11T14:30:00Z",\n  "secret_version": 2\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Important:"})," Update your signature verification code with the new secret before the previous one expires."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"deliveries",children:"Deliveries"}),"\n",(0,t.jsx)(n.h3,{id:"list-deliveries",children:"List Deliveries"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"GET /webhooks/{endpoint_id}/deliveries?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Query Parameters:"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"status"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsxs)(n.td,{children:["Filter: ",(0,t.jsx)(n.code,{children:"pending"}),", ",(0,t.jsx)(n.code,{children:"success"}),", ",(0,t.jsx)(n.code,{children:"failed"}),", ",(0,t.jsx)(n.code,{children:"retrying"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"limit"})}),(0,t.jsx)(n.td,{children:"int"}),(0,t.jsx)(n.td,{children:"Max results (default: 50)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"offset"})}),(0,t.jsx)(n.td,{children:"int"}),(0,t.jsx)(n.td,{children:"Pagination offset"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "deliveries": [\n    {\n      "id": "d-12345",\n      "delivery_id": "550e8400-e29b-41d4-a716-446655440001",\n      "event_type": "alert.triggered",\n      "status": "success",\n      "attempt_number": 1,\n      "response_status_code": 200,\n      "response_time_ms": 145,\n      "created_at": "2025-01-10T14:30:00Z",\n      "completed_at": "2025-01-10T14:30:01Z"\n    }\n  ],\n  "total": 156\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"get-delivery-details",children:"Get Delivery Details"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"GET /webhooks/{endpoint_id}/deliveries/{delivery_id}?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Returns full delivery details including payload and response."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "id": "d-12345",\n  "delivery_id": "550e8400-e29b-41d4-a716-446655440001",\n  "event_type": "alert.triggered",\n  "status": "success",\n  "payload": {\n    "event": "alert.triggered",\n    "data": {...}\n  },\n  "payload_size_bytes": 1234,\n  "attempt_number": 1,\n  "response_status_code": 200,\n  "response_body": "OK",\n  "response_time_ms": 145,\n  "created_at": "2025-01-10T14:30:00Z",\n  "completed_at": "2025-01-10T14:30:01Z"\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"replay-delivery",children:"Replay Delivery"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"POST /webhooks/{endpoint_id}/deliveries/{delivery_id}/replay?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Replays a failed delivery with the same payload."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Request Body (optional):"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "force": true\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Set ",(0,t.jsx)(n.code,{children:"force: true"})," to replay a delivery that already succeeded."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "success": true,\n  "new_delivery_id": "550e8400-e29b-41d4-a716-446655440002",\n  "message": "Delivery queued for retry"\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"bulk-replay",children:"Bulk Replay"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"POST /webhooks/bulk/replay?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Replay multiple failed deliveries at once."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "delivery_ids": [\n    "550e8400-e29b-41d4-a716-446655440001",\n    "550e8400-e29b-41d4-a716-446655440002"\n  ],\n  "force": false\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"statistics",children:"Statistics"}),"\n",(0,t.jsx)(n.h3,{id:"get-endpoint-statistics",children:"Get Endpoint Statistics"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"GET /webhooks/{endpoint_id}/stats?site_id={site_id}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Query Parameters:"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"hours"})}),(0,t.jsx)(n.td,{children:"int"}),(0,t.jsx)(n.td,{children:"Hours to look back (default: 24, max: 720)"})]})})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Response:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "endpoint": {...},\n  "stats": {\n    "total_deliveries": 156,\n    "successful": 150,\n    "failed": 4,\n    "pending": 2,\n    "success_rate": 96.2,\n    "avg_response_time_ms": 125\n  },\n  "recent_failures": [\n    {\n      "delivery_id": "d-12345",\n      "error_type": "timeout",\n      "error_message": "Request timed out after 30s",\n      "created_at": "2025-01-10T14:00:00Z"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"webhook-payload",children:"Webhook Payload"}),"\n",(0,t.jsx)(n.p,{children:"All webhooks are sent as HTTP POST requests with JSON body:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "event": "alert.triggered",\n  "event_id": "evt_abc123",\n  "timestamp": "2025-01-10T14:30:00Z",\n  "site_id": "acme",\n  "data": {\n    // Event-specific data\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"alert-triggered",children:"Alert Triggered"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "event": "alert.triggered",\n  "event_id": "evt_abc123",\n  "timestamp": "2025-01-10T14:30:00Z",\n  "site_id": "acme",\n  "data": {\n    "alert_id": 123,\n    "rule_name": "Traffic Drop",\n    "severity": "warning",\n    "message": "Traffic dropped 35% compared to previous period",\n    "metric": "entrances",\n    "current_value": 650,\n    "expected_value": 1000,\n    "threshold_percent": 25,\n    "triggered_at": "2025-01-10T14:30:00Z"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"export-completed",children:"Export Completed"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "event": "export.completed",\n  "event_id": "evt_def456",\n  "timestamp": "2025-01-10T15:00:00Z",\n  "site_id": "acme",\n  "data": {\n    "export_id": "exp_abc123",\n    "export_type": "pageviews",\n    "row_count": 15234,\n    "file_size_bytes": 2456789,\n    "download_url": "https://my.sealmetrics.com/api/v1/exports/download/token123",\n    "expires_at": "2025-01-17T15:00:00Z"\n  }\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"signature-verification",children:"Signature Verification"}),"\n",(0,t.jsx)(n.p,{children:"All webhooks include a signature header for verification:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"X-Sealmetrics-Signature: sha256=abc123...\nX-Sealmetrics-Timestamp: 1704898200\n"})}),"\n",(0,t.jsx)(n.h3,{id:"verification-steps",children:"Verification Steps"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Extract the timestamp and signature from headers"}),"\n",(0,t.jsxs)(n.li,{children:["Prepare the signed payload: ",(0,t.jsx)(n.code,{children:"{timestamp}.{request_body}"})]}),"\n",(0,t.jsx)(n.li,{children:"Compute HMAC-SHA256 with your webhook secret"}),"\n",(0,t.jsx)(n.li,{children:"Compare with the provided signature"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"python-example",children:"Python Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import hmac\nimport hashlib\n\ndef verify_webhook(request_body: bytes, signature: str, timestamp: str, secret: str) -> bool:\n    # Prepare signed payload\n    signed_payload = f\"{timestamp}.{request_body.decode()}\"\n\n    # Compute expected signature\n    expected = hmac.new(\n        secret.encode(),\n        signed_payload.encode(),\n        hashlib.sha256\n    ).hexdigest()\n\n    # Extract signature value (remove 'sha256=' prefix)\n    provided = signature.replace('sha256=', '')\n\n    return hmac.compare_digest(expected, provided)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"nodejs-example",children:"Node.js Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const crypto = require('crypto');\n\nfunction verifyWebhook(body, signature, timestamp, secret) {\n  const signedPayload = `${timestamp}.${body}`;\n\n  const expected = crypto\n    .createHmac('sha256', secret)\n    .update(signedPayload)\n    .digest('hex');\n\n  const provided = signature.replace('sha256=', '');\n\n  return crypto.timingSafeEqual(\n    Buffer.from(expected),\n    Buffer.from(provided)\n  );\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"1-verify-signatures",children:"1. Verify Signatures"}),"\n",(0,t.jsx)(n.p,{children:"Always verify webhook signatures to ensure requests are from Sealmetrics:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"if not verify_webhook(request.body, request.headers['X-Sealmetrics-Signature'],\n                       request.headers['X-Sealmetrics-Timestamp'], WEBHOOK_SECRET):\n    return Response(status=401)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-respond-quickly",children:"2. Respond Quickly"}),"\n",(0,t.jsx)(n.p,{children:"Return a 2xx response within 30 seconds. Process asynchronously if needed:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'@app.post("/webhook")\nasync def handle_webhook(request: Request, background_tasks: BackgroundTasks):\n    # Verify signature first\n    verify_webhook(...)\n\n    # Queue for processing\n    background_tasks.add_task(process_webhook, request.json())\n\n    # Return immediately\n    return {"received": True}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"3-handle-duplicates",children:"3. Handle Duplicates"}),"\n",(0,t.jsxs)(n.p,{children:["Webhooks may be retried. Use ",(0,t.jsx)(n.code,{children:"event_id"})," for idempotency:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'if redis.sismember("processed_events", event_id):\n    return {"status": "already_processed"}\n\nredis.sadd("processed_events", event_id)\nredis.expire("processed_events", 86400 * 7)  # 7 days\n'})}),"\n",(0,t.jsx)(n.h3,{id:"4-use-https",children:"4. Use HTTPS"}),"\n",(0,t.jsx)(n.p,{children:"Always use HTTPS endpoints. HTTP endpoints are rejected."}),"\n",(0,t.jsx)(n.h3,{id:"5-rotate-secrets-periodically",children:"5. Rotate Secrets Periodically"}),"\n",(0,t.jsx)(n.p,{children:"Rotate webhook secrets every 90 days for security:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST "https://my.sealmetrics.com/api/v1/webhooks/{id}/rotate-secret?site_id=acme" \\\n  -H "X-API-Key: sm_your_key"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);