"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[4454],{28453:(e,s,n)=>{n.d(s,{R:()=>d,x:()=>c});var r=n(96540);const i={},t=r.createContext(i);function d(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(t.Provider,{value:s},e.children)}},71302:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"api/auth-advanced","title":"Auth Advanced","description":"Complete reference for session management, password reset, and two-factor authentication.","source":"@site/docs/api/auth-advanced.mdx","sourceDirName":"api","slug":"/api/auth-advanced","permalink":"/api/auth-advanced","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10,"title":"Auth Advanced"},"sidebar":"tutorialSidebar","previous":{"title":"Period Comparison","permalink":"/api/comparison"},"next":{"title":"Exports","permalink":"/api/exports"}}');var i=n(74848),t=n(28453);const d={sidebar_position:10,title:"Auth Advanced"},c="Advanced Authentication",a={},l=[{value:"Session Management",id:"session-management",level:2},{value:"List Sessions",id:"list-sessions",level:3},{value:"Terminate Session",id:"terminate-session",level:3},{value:"Logout All Sessions",id:"logout-all-sessions",level:3},{value:"Logout Current Session",id:"logout-current-session",level:3},{value:"Password Reset",id:"password-reset",level:2},{value:"Request Password Reset",id:"request-password-reset",level:3},{value:"Reset Password",id:"reset-password",level:3},{value:"Two-Factor Authentication (2FA)",id:"two-factor-authentication-2fa",level:2},{value:"Check 2FA Status",id:"check-2fa-status",level:3},{value:"Enable 2FA - Step 1: Setup",id:"enable-2fa---step-1-setup",level:3},{value:"Enable 2FA - Step 2: Verify",id:"enable-2fa---step-2-verify",level:3},{value:"Cancel 2FA Setup",id:"cancel-2fa-setup",level:3},{value:"Disable 2FA",id:"disable-2fa",level:3},{value:"Regenerate Backup Codes",id:"regenerate-backup-codes",level:3},{value:"Login with 2FA",id:"login-with-2fa",level:2},{value:"Step 1: Initial Login",id:"step-1-initial-login",level:3},{value:"Step 2: Verify 2FA Code",id:"step-2-verify-2fa-code",level:3},{value:"Error Codes",id:"error-codes",level:2},{value:"Authentication Errors",id:"authentication-errors",level:3},{value:"2FA Errors",id:"2fa-errors",level:3},{value:"Session Errors",id:"session-errors",level:3},{value:"Code Examples",id:"code-examples",level:2},{value:"Python - Complete 2FA Login Flow",id:"python---complete-2fa-login-flow",level:3},{value:"JavaScript - Session Management",id:"javascript---session-management",level:3},{value:"Security: Force Logout After Suspicious Activity",id:"security-force-logout-after-suspicious-activity",level:3}];function o(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"advanced-authentication",children:"Advanced Authentication"})}),"\n",(0,i.jsx)(s.p,{children:"Complete reference for session management, password reset, and two-factor authentication."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"session-management",children:"Session Management"}),"\n",(0,i.jsx)(s.p,{children:"Sealmetrics tracks user sessions with device and IP information. Users can view and terminate sessions from any device."}),"\n",(0,i.jsx)(s.h3,{id:"list-sessions",children:"List Sessions"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"GET /auth/sessions\n"})}),"\n",(0,i.jsx)(s.p,{children:"Returns all active sessions for the current user."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "sessions": [\n      {\n        "id": 123,\n        "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)...",\n        "ip_address": "85.123.45.67",\n        "created_at": "2025-01-08T10:30:00Z",\n        "last_used_at": "2025-01-10T14:25:00Z",\n        "is_current": true\n      },\n      {\n        "id": 121,\n        "user_agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 17_0)...",\n        "ip_address": "92.45.123.89",\n        "created_at": "2025-01-05T08:15:00Z",\n        "last_used_at": "2025-01-09T18:42:00Z",\n        "is_current": false\n      }\n    ],\n    "total": 2\n  }\n}\n'})}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"id"})}),(0,i.jsx)(s.td,{children:"Session ID for termination"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"user_agent"})}),(0,i.jsx)(s.td,{children:"Browser/device information"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ip_address"})}),(0,i.jsx)(s.td,{children:"IP address of the session"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"created_at"})}),(0,i.jsx)(s.td,{children:"When the session was created (login time)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"last_used_at"})}),(0,i.jsx)(s.td,{children:"Last API request with this session"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"is_current"})}),(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"true"})," if this is the session making the request"]})]})]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"terminate-session",children:"Terminate Session"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"DELETE /auth/sessions/{session_id}\n"})}),"\n",(0,i.jsx)(s.p,{children:"Terminate a specific session (logs out that device)."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "message": "Session terminated successfully"\n  }\n}\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"logout-all-sessions",children:"Logout All Sessions"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"DELETE /auth/sessions\n"})}),"\n",(0,i.jsx)(s.p,{children:"Terminate all sessions except the current one (force logout from all devices)."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Query Parameters:"})}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Parameter"}),(0,i.jsx)(s.th,{children:"Type"}),(0,i.jsx)(s.th,{children:"Default"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"include_current"})}),(0,i.jsx)(s.td,{children:"boolean"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"false"})}),(0,i.jsx)(s.td,{children:"Also terminate current session"})]})})]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "message": "All sessions terminated successfully",\n    "sessions_terminated": 3\n  }\n}\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"logout-current-session",children:"Logout Current Session"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /auth/logout\n"})}),"\n",(0,i.jsx)(s.p,{children:"Logout the current session only."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "message": "Logged out successfully"\n  }\n}\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"password-reset",children:"Password Reset"}),"\n",(0,i.jsx)(s.h3,{id:"request-password-reset",children:"Request Password Reset"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /auth/forgot-password\n"})}),"\n",(0,i.jsx)(s.p,{children:"Send a password reset email."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "email": "user@example.com"\n}\n'})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "message": "If the email exists, a password reset link has been sent"\n  }\n}\n'})}),"\n",(0,i.jsx)(s.admonition,{title:"Security",type:"note",children:(0,i.jsx)(s.p,{children:"The response is always the same regardless of whether the email exists. This prevents email enumeration attacks."})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"reset-password",children:"Reset Password"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /auth/reset-password\n"})}),"\n",(0,i.jsx)(s.p,{children:"Reset password using the token from the email."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "token": "abc123def456...",\n  "new_password": "MyNewSecurePassword123!"\n}\n'})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "message": "Password has been reset successfully",\n    "sessions_terminated": 2\n  }\n}\n'})}),"\n",(0,i.jsx)(s.admonition,{type:"warning",children:(0,i.jsx)(s.p,{children:"All existing sessions are terminated after a password reset. The user must log in again on all devices."})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"two-factor-authentication-2fa",children:"Two-Factor Authentication (2FA)"}),"\n",(0,i.jsx)(s.p,{children:"Sealmetrics supports TOTP-based two-factor authentication compatible with apps like Google Authenticator, Authy, and 1Password."}),"\n",(0,i.jsx)(s.h3,{id:"check-2fa-status",children:"Check 2FA Status"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"GET /2fa/status\n"})}),"\n",(0,i.jsx)(s.p,{children:"Check if 2FA is enabled for the current user."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "enabled": true,\n    "enabled_at": "2024-12-15T10:30:00Z",\n    "backup_codes_remaining": 8\n  }\n}\n'})}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"enabled"})}),(0,i.jsx)(s.td,{children:"Whether 2FA is active"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"enabled_at"})}),(0,i.jsx)(s.td,{children:"When 2FA was enabled"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"backup_codes_remaining"})}),(0,i.jsx)(s.td,{children:"Number of unused backup codes"})]})]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"enable-2fa---step-1-setup",children:"Enable 2FA - Step 1: Setup"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /2fa/setup\n"})}),"\n",(0,i.jsx)(s.p,{children:"Start 2FA setup. Requires password verification."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "password": "CurrentPassword123!"\n}\n'})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "secret": "JBSWY3DPEHPK3PXP",\n    "qr_code_data_url": "data:image/png;base64,iVBORw0KGgo...",\n    "backup_codes": [\n      "ABCD-1234-EFGH",\n      "IJKL-5678-MNOP",\n      "QRST-9012-UVWX",\n      "..."\n    ],\n    "provisioning_uri": "otpauth://totp/Sealmetrics:user@example.com?secret=JBSWY3DPEHPK3PXP&issuer=Sealmetrics",\n    "expires_in_minutes": 10\n  }\n}\n'})}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"secret"})}),(0,i.jsx)(s.td,{children:"TOTP secret for manual entry"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"qr_code_data_url"})}),(0,i.jsx)(s.td,{children:"Base64 PNG for QR code display"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"backup_codes"})}),(0,i.jsx)(s.td,{children:"Recovery codes (store securely, shown once)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"provisioning_uri"})}),(0,i.jsx)(s.td,{children:"URI for manual authenticator setup"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"expires_in_minutes"})}),(0,i.jsx)(s.td,{children:"Time until setup expires"})]})]})]}),"\n",(0,i.jsx)(s.admonition,{type:"warning",children:(0,i.jsx)(s.p,{children:"Save the backup codes immediately. They are only shown once and cannot be retrieved later."})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"enable-2fa---step-2-verify",children:"Enable 2FA - Step 2: Verify"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /2fa/setup/verify\n"})}),"\n",(0,i.jsx)(s.p,{children:"Complete setup by verifying a code from the authenticator app."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "code": "123456"\n}\n'})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "message": "Two-factor authentication enabled successfully"\n  }\n}\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"cancel-2fa-setup",children:"Cancel 2FA Setup"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /2fa/setup/cancel\n"})}),"\n",(0,i.jsx)(s.p,{children:"Cancel pending 2FA setup if not completed."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"disable-2fa",children:"Disable 2FA"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /2fa/disable\n"})}),"\n",(0,i.jsx)(s.p,{children:"Disable two-factor authentication. Requires password and current 2FA code."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "password": "CurrentPassword123!",\n  "code": "123456"\n}\n'})}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"code"})," can be either a 6-digit TOTP code or a backup code."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"regenerate-backup-codes",children:"Regenerate Backup Codes"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /2fa/backup-codes/regenerate\n"})}),"\n",(0,i.jsx)(s.p,{children:"Generate new backup codes. Old codes are invalidated."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "code": "123456"\n}\n'})}),"\n",(0,i.jsx)(s.p,{children:"Requires a valid TOTP code (not backup code)."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "backup_codes": [\n      "WXYZ-3456-ABCD",\n      "EFGH-7890-IJKL",\n      "..."\n    ],\n    "count": 10\n  }\n}\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"login-with-2fa",children:"Login with 2FA"}),"\n",(0,i.jsx)(s.p,{children:"When 2FA is enabled, the login flow has an additional step."}),"\n",(0,i.jsx)(s.h3,{id:"step-1-initial-login",children:"Step 1: Initial Login"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /auth/token\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "email": "user@example.com",\n  "password": "Password123!"\n}\n'})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response (2FA Required):"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "requires_2fa": true,\n    "user_id": 123,\n    "message": "Two-factor authentication required"\n  }\n}\n'})}),"\n",(0,i.jsx)(s.h3,{id:"step-2-verify-2fa-code",children:"Step 2: Verify 2FA Code"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-http",children:"POST /2fa/verify-login\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "user_id": 123,\n  "code": "123456",\n  "is_backup_code": false\n}\n'})}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Field"}),(0,i.jsx)(s.th,{children:"Type"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"user_id"})}),(0,i.jsx)(s.td,{children:"integer"}),(0,i.jsx)(s.td,{children:"User ID from Step 1 response"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"code"})}),(0,i.jsx)(s.td,{children:"string"}),(0,i.jsx)(s.td,{children:"6-digit TOTP or backup code"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"is_backup_code"})}),(0,i.jsx)(s.td,{children:"boolean"}),(0,i.jsxs)(s.td,{children:["Set ",(0,i.jsx)(s.code,{children:"true"})," if using backup code"]})]})]})]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Response (Success):"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-json",children:'{\n  "success": true,\n  "data": {\n    "access_token": "eyJhbGciOiJIUzI1NiIs...",\n    "token_type": "bearer",\n    "expires_in": 3600,\n    "user": {\n      "id": 123,\n      "email": "user@example.com",\n      "name": "John Doe",\n      "role": "admin"\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"error-codes",children:"Error Codes"}),"\n",(0,i.jsx)(s.h3,{id:"authentication-errors",children:"Authentication Errors"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"HTTP"}),(0,i.jsx)(s.th,{children:"Error Code"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"401"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"invalid_credentials"})}),(0,i.jsx)(s.td,{children:"Wrong email or password"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"401"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"invalid_token"})}),(0,i.jsx)(s.td,{children:"JWT token is invalid or expired"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"401"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"invalid_api_key"})}),(0,i.jsx)(s.td,{children:"API key not found or revoked"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"403"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"email_not_verified"})}),(0,i.jsx)(s.td,{children:"Email verification required"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"403"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"ip_not_allowed"})}),(0,i.jsx)(s.td,{children:"IP not in allowlist (Enterprise)"})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"2fa-errors",children:"2FA Errors"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"HTTP"}),(0,i.jsx)(s.th,{children:"Error Code"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"400"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"2fa_already_enabled"})}),(0,i.jsx)(s.td,{children:"2FA is already active"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"400"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"2fa_not_enabled"})}),(0,i.jsx)(s.td,{children:"2FA is not enabled for this user"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"400"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"invalid_code"})}),(0,i.jsx)(s.td,{children:"TOTP or backup code is incorrect"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"400"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"setup_expired"})}),(0,i.jsx)(s.td,{children:"2FA setup window expired"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"429"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"rate_limit_exceeded"})}),(0,i.jsx)(s.td,{children:"Too many failed verification attempts"})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"session-errors",children:"Session Errors"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"HTTP"}),(0,i.jsx)(s.th,{children:"Error Code"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"400"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"session_management_unavailable"})}),(0,i.jsx)(s.td,{children:"API keys cannot manage sessions"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"404"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"session_not_found"})}),(0,i.jsx)(s.td,{children:"Session ID not found"})]})]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"code-examples",children:"Code Examples"}),"\n",(0,i.jsx)(s.h3,{id:"python---complete-2fa-login-flow",children:"Python - Complete 2FA Login Flow"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'import requests\n\nBASE_URL = "https://api.sealmetrics.com/api/v1"\n\ndef login_with_2fa(email, password, totp_code):\n    # Step 1: Initial login\n    response = requests.post(\n        f"{BASE_URL}/auth/token",\n        json={"email": email, "password": password}\n    )\n    data = response.json()["data"]\n\n    # Check if 2FA is required\n    if data.get("requires_2fa"):\n        # Step 2: Verify 2FA\n        response = requests.post(\n            f"{BASE_URL}/2fa/verify-login",\n            json={\n                "user_id": data["user_id"],\n                "code": totp_code,\n                "is_backup_code": False\n            }\n        )\n        data = response.json()["data"]\n\n    return data["access_token"]\n'})}),"\n",(0,i.jsx)(s.h3,{id:"javascript---session-management",children:"JavaScript - Session Management"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-javascript",children:"const API_KEY = 'str_your_api_key';\nconst BASE_URL = 'https://api.sealmetrics.com/api/v1';\n\nasync function getSessions(token) {\n  const response = await fetch(`${BASE_URL}/auth/sessions`, {\n    headers: { 'Authorization': `Bearer ${token}` }\n  });\n  return response.json();\n}\n\nasync function logoutOtherDevices(token) {\n  // Keep current session, logout all others\n  const response = await fetch(`${BASE_URL}/auth/sessions`, {\n    method: 'DELETE',\n    headers: { 'Authorization': `Bearer ${token}` }\n  });\n  return response.json();\n}\n\nasync function terminateSession(token, sessionId) {\n  const response = await fetch(`${BASE_URL}/auth/sessions/${sessionId}`, {\n    method: 'DELETE',\n    headers: { 'Authorization': `Bearer ${token}` }\n  });\n  return response.json();\n}\n"})}),"\n",(0,i.jsx)(s.h3,{id:"security-force-logout-after-suspicious-activity",children:"Security: Force Logout After Suspicious Activity"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'async def handle_suspicious_activity(user_token):\n    """Force logout all sessions when suspicious activity detected."""\n\n    # Terminate all sessions including current\n    response = requests.delete(\n        f"{BASE_URL}/auth/sessions",\n        headers={"Authorization": f"Bearer {user_token}"},\n        params={"include_current": True}\n    )\n\n    if response.status_code == 200:\n        # User will need to re-authenticate\n        return True\n\n    return False\n'})})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);